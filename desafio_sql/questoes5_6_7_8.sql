-- Questão 5 --
CREATE TABLE CLIENTES (
    CPF VARCHAR(11) PRIMARY KEY,
    NOME VARCHAR(100) NOT NULL,
    IDADE INT NOT NULL
);

CREATE TABLE TELEFONES (
    CPF_CLIENTE VARCHAR(11),
    DDD CHAR(2) NOT NULL,
    TELEFONE VARCHAR(9) NOT NULL,
    PRIMARY KEY (CPF_CLIENTE, TELEFONE),
    FOREIGN KEY (CPF_CLIENTE) REFERENCES CLIENTES(CPF) ON DELETE CASCADE
);

INSERT INTO CLIENTES (CPF, NOME, IDADE) VALUES
('11111111111', 'Ana Souza', 25),
('22222222222', 'Carlos Santos', 30),
('33333333333', 'Maria Oliveira', 22),
('44444444444', 'João Santos', 28),
('55555555555', 'Pedro Lima', 19),
('66666666666', 'Juliana Santos', 17);

select * from clientes;

INSERT INTO TELEFONES (CPF_CLIENTE, DDD, TELEFONE) VALUES
('11111111111', '11', '987654321'),
('11111111111', '11', '987655908'),
('22222222222', '21', '998877665'),
('22222222222', '21', '991234567'),
('33333333333', '31', '976543210'),
('44444444444', '41', '965432109'),
('55555555555', '21', '998980056');

select * from telefones;

-- Questão 6 --
SELECT NOME, IDADE 
FROM CLIENTES 
WHERE IDADE >= 22 
ORDER BY IDADE ASC;

-- Questão 7 --
SELECT C.NOME, COUNT(T.TELEFONE) AS QUANTIDADE_TELEFONES
FROM CLIENTES C
JOIN TELEFONES T ON C.CPF = T.CPF_CLIENTE
GROUP BY C.NOME
HAVING QUANTIDADE_TELEFONES >= 1;

-- Questão 8 --
DELETE FROM CLIENTES 
WHERE NOME LIKE '% Santos';
